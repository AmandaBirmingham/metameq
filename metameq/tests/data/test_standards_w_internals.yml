# Test standards file with internal (underscore-prefixed) entries
# for testing exclude_internals filtering.
# Same as test_standards.yml but with:
#   - _internal host (sibling of human/mouse under host_associated)
#   - _debug sample type (at host_associated level, inherited by children)
# When exclude_internals=True filters these out, the result matches
# the output from test_standards.yml exactly.
"metadata_transformers":
  "pre_transformers":
    collection_date:
      sources:
        - "collection_timestamp"
      function: "transform_date_to_formatted_date"
# Structure: base -> host_associated -> human/mouse/_internal
host_type_specific_metadata:
  base:
    # Fields defined at base level are inherited by all host types
    metadata_fields:
      sample_name:
        type: string
        unique: true
        required: true
      sample_type:
        type: string
        required: true
    host_type_specific_metadata:
      host_associated:
        # default at this level is inherited by human, mouse, and _internal
        default: "not provided"
        metadata_fields:
          # description is defined here and can be overridden by child hosts
          description:
            type: string
            default: "host associated sample"
        sample_type_specific_metadata:
          # stool defined at host_associated level, inherited by children
          stool:
            metadata_fields:
              body_site:
                type: string
                default: "gut"
          # _debug is an internal sample type that should be filtered out
          _debug:
            metadata_fields:
              body_site:
                type: string
                default: "debug_site"
        host_type_specific_metadata:
          human:
            metadata_fields:
              # host_common_name is defined only at human level
              host_common_name:
                type: string
                default: "human"
              # description overrides the parent host_associated value
              description:
                type: string
                default: "human sample"
            sample_type_specific_metadata:
              # stool at human level adds body_product, inherits body_site from parent
              stool:
                metadata_fields:
                  body_product:
                    type: string
                    default: "UBERON:feces"
              # blood is only defined for human, not at host_associated level
              blood:
                metadata_fields:
                  body_site:
                    type: string
                    default: "blood"
                  body_product:
                    type: string
                    default: "UBERON:blood"
          mouse:
            metadata_fields:
              # host_common_name is defined only at mouse level
              host_common_name:
                type: string
                default: "mouse"
              # mouse inherits description from host_associated (doesn't override)
            sample_type_specific_metadata:
              # mouse stool inherits from host_associated stool
              # but adds cage_id field specific to mouse
              stool:
                metadata_fields:
                  cage_id:
                    type: string
                    required: false
          # _internal is an internal host type that should be filtered out
          _internal:
            metadata_fields:
              host_common_name:
                type: string
                default: "internal"
              description:
                type: string
                default: "internal sample"
